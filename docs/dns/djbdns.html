

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>djbdns (How to setup your own DNS) &mdash; Bookmarks rc documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Bookmarks
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../linux/index.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ruby/index.html">Ruby</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bookmarks</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>djbdns (How to setup your own DNS)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/dns/djbdns.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="djbdns-how-to-setup-your-own-dns">
<span id="djbdns-how-to-setup-your-own-dns"></span><h1>djbdns (How to setup your own DNS)<a class="headerlink" href="#djbdns-how-to-setup-your-own-dns" title="Permalink to this headline">¶</a></h1>
<p>The following will give you a good background on how dns works. At the most basic level setting up your own DNS requries two different programs. a DNS cache and a DNS server. The cache will handle lookups and will delegate to your internal DNS server when needed. For all other queries it will use one of the root DNS servers https://en.wikipedia.org/wiki/Root_name_server.</p>
<ul class="simple">
<li>http://cr.yp.to/djbdns/intro-dns.html</li>
</ul>
<p>For installing the dns server you can follow this link.</p>
<ul class="simple">
<li>http://askubuntu.com/questions/53352/how-do-i-setup-an-authoritative-name-server-with-tinydns</li>
</ul>
<p>However by itself this is worthless since any computer set to use this dns will fail on any domain not in it’s data file. Also note that in this setup we are going to put the dnscache and dnsserver on the same computer so you will want to use 127.0.0.1 for the ip when setting up tinydns. This is because dns cache and tiny dns run on the same port however you only need your dns server available to the dns cache since users should not be directly talking to your dns server.</p>
<p>For setting up dns cache it’s the exact same as the link above except you should make a dnscache user and create the service using dnscache-conf. If you followed the steps above correctly all the required binaries should be available on your system already. The following link has a small section on setting up dnscache if you need further help. I also explains how to allow others on the network to query your dns server.</p>
<ul class="simple">
<li>http://www.fredshack.com/docs/djbdns.html</li>
</ul>
<p>Extra dnscache reading</p>
<ul class="simple">
<li>http://thedjbway.b0llix.net/djbdns/dnscache.html</li>
</ul>
<p>Both of these services are run with daemontools so starting and stopping the service looks like this in my setup.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># start service</span>
<span class="n">sudo</span> <span class="n">svc</span> <span class="o">-</span><span class="n">u</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">tinydns</span>
<span class="c1"># stop service</span>
<span class="n">sudo</span> <span class="n">svc</span> <span class="o">-</span><span class="n">d</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">tinydns</span>
<span class="c1"># restart</span>
<span class="n">sudo</span> <span class="n">svc</span> <span class="o">-</span><span class="n">t</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">tinydns</span>
</pre></div>
</div>
<p>Read over <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">svc</span></code> for more information. The following link also contains an in depth look.</p>
<ul class="simple">
<li>https://cr.yp.to/daemontools.html</li>
</ul>
<p>When troubleshooting issues the following command came in very useful. If you are having issues first stop dns cache and the dns server. Manually start the programs with the ./run binary located in the root of tinydns or dnscache so you can see all logs in real time. If you are having issues with anything resolving you can use the following.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnsqr</span> <span class="nb">any</span> <span class="n">google</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>This will query the dns server set in resolve.conf which should point to the server your dns cache is setup on. If nothing is returned you may need to update your list of root DNS servers or the machine your cache is running on may not have an internet conection. If you are able to query sites such as google.com but can’t get your internal dns to resolve make sure that in your dns cache root directory you have a file such as example.local with an ip of 127.0.0.1. This will ensure that when a query for something.example.local comes in your local dns server is used instead of the root DNS servers.</p>
<p>If you are having trouble getting tinydns to resolve you can verify that it is properly working by cd’ing into the directory that contains your data.cdb file and running <code class="docutils literal notranslate"><span class="pre">tinydns-get</span> <span class="pre">any</span> <span class="pre">your.domain</span></code>. If nothing is returned you make need to run <code class="docutils literal notranslate"><span class="pre">make</span></code> again to regenerate your db. The link below contains more on tinydns-data.</p>
<ul class="simple">
<li>https://cr.yp.to/djbdns/tinydns-data.html</li>
</ul>
<p>Extras</p>
<ol class="simple">
<li>http://www.mn-linux.org/meetings/pastnotes/djbdns.pdf</li>
<li>http://www.troubleshooters.com/linux/djbdns/djbdns_tshoot.htm</li>
<li>https://cr.yp.to/djbdns/run-server.html</li>
</ol>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Michael Schuett.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'rc',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>