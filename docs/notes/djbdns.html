
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>djbdns (How to setup your own DNS) &#8212; Bookmarks rc documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="djbdns-how-to-setup-your-own-dns">
<span id="djbdns-how-to-setup-your-own-dns"></span><h1>djbdns (How to setup your own DNS)<a class="headerlink" href="#djbdns-how-to-setup-your-own-dns" title="Permalink to this headline">¶</a></h1>
<p>The following will give you a good background on how dns works. At the most basic level setting up your own DNS requries two different programs. a DNS cache and a DNS server. The cache will handle lookups and will delegate to your internal DNS server when needed. For all other queries it will use one of the root DNS servers https://en.wikipedia.org/wiki/Root_name_server.</p>
<ul class="simple">
<li>http://cr.yp.to/djbdns/intro-dns.html</li>
</ul>
<p>For installing the dns server you can follow this link.</p>
<ul class="simple">
<li>http://askubuntu.com/questions/53352/how-do-i-setup-an-authoritative-name-server-with-tinydns</li>
</ul>
<p>However by itself this is worthless since any computer set to use this dns will fail on any domain not in it’s data file. Also note that in this setup we are going to put the dnscache and dnsserver on the same computer so you will want to use 127.0.0.1 for the ip when setting up tinydns. This is because dns cache and tiny dns run on the same port however you only need your dns server available to the dns cache since users should not be directly talking to your dns server.</p>
<p>For setting up dns cache it’s the exact same as the link above except you should make a dnscache user and create the service using dnscache-conf. If you followed the steps above correctly all the required binaries should be available on your system already. The following link has a small section on setting up dnscache if you need further help. I also explains how to allow others on the network to query your dns server.</p>
<ul class="simple">
<li>http://www.fredshack.com/docs/djbdns.html</li>
</ul>
<p>Extra dnscache reading</p>
<ul class="simple">
<li>http://thedjbway.b0llix.net/djbdns/dnscache.html</li>
</ul>
<p>Both of these services are run with daemontools so starting and stopping the service looks like this in my setup.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># start service</span>
<span class="n">sudo</span> <span class="n">svc</span> <span class="o">-</span><span class="n">u</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">tinydns</span>
<span class="c1"># stop service</span>
<span class="n">sudo</span> <span class="n">svc</span> <span class="o">-</span><span class="n">d</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">tinydns</span>
<span class="c1"># restart</span>
<span class="n">sudo</span> <span class="n">svc</span> <span class="o">-</span><span class="n">t</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">tinydns</span>
</pre></div>
</div>
<p>Read over <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">svc</span></code> for more information. The following link also contains an in depth look.</p>
<ul class="simple">
<li>https://cr.yp.to/daemontools.html</li>
</ul>
<p>When troubleshooting issues the following command came in very useful. If you are having issues first stop dns cache and the dns server. Manually start the programs with the ./run binary located in the root of tinydns or dnscache so you can see all logs in real time. If you are having issues with anything resolving you can use the following.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnsqr</span> <span class="nb">any</span> <span class="n">google</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>This will query the dns server set in resolve.conf which should point to the server your dns cache is setup on. If nothing is returned you may need to update your list of root DNS servers or the machine your cache is running on may not have an internet conection. If you are able to query sites such as google.com but can’t get your internal dns to resolve make sure that in your dns cache root directory you have a file such as example.local with an ip of 127.0.0.1. This will ensure that when a query for something.example.local comes in your local dns server is used instead of the root DNS servers.</p>
<p>If you are having trouble getting tinydns to resolve you can verify that it is properly working by cd’ing into the directory that contains your data.cdb file and running <code class="docutils literal notranslate"><span class="pre">tinydns-get</span> <span class="pre">any</span> <span class="pre">your.domain</span></code>. If nothing is returned you make need to run <code class="docutils literal notranslate"><span class="pre">make</span></code> again to regenerate your db. The link below contains more on tinydns-data.</p>
<ul class="simple">
<li>https://cr.yp.to/djbdns/tinydns-data.html</li>
</ul>
<p>Extras</p>
<ol class="simple">
<li>http://www.mn-linux.org/meetings/pastnotes/djbdns.pdf</li>
<li>http://www.troubleshooters.com/linux/djbdns/djbdns_tshoot.htm</li>
<li>https://cr.yp.to/djbdns/run-server.html</li>
</ol>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Bookmarks</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Michael Schuett.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.9</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../_sources/notes/djbdns.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>